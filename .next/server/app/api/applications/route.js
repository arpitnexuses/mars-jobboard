"use strict";(()=>{var e={};e.id=569,e.ids=[569],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5315:e=>{e.exports=require("path")},2087:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var o={};r.r(o),r.d(o,{POST:()=>c});var n=r(9303),a=r(8716),s=r(670),i=r(7070),p=r(4184);let u=require("fs/promises");var l=r(5315);async function c(e){try{let t=await e.formData(),o=t.get("resume");if(!o)return i.NextResponse.json({error:"Resume file is required"},{status:400});if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(o.type))return i.NextResponse.json({error:"Invalid file type. Only PDF and Word documents are allowed."},{status:400});if(o.size>10485760)return i.NextResponse.json({error:"File size exceeds 10MB limit."},{status:400});let n=await o.arrayBuffer(),a=Buffer.from(n),s=Date.now(),c=o.name.replace(/[^a-zA-Z0-9.]/g,"_"),d=`${s}-${c}`,m=(0,l.join)(process.cwd(),"public","uploads","resumes");await (0,u.writeFile)((0,l.join)(m,d),a);let f=`/uploads/resumes/${d}`,g={jobId:t.get("jobId"),firstName:t.get("firstName"),lastName:t.get("lastName"),email:t.get("email"),phone:t.get("phone"),experience:t.get("experience"),education:t.get("education"),coverLetter:t.get("coverLetter"),resume:f,appliedAt:new Date};if(!g.jobId||!g.firstName||!g.lastName||!g.email||!g.phone||!g.experience||!g.education||!g.coverLetter||!g.resume)return i.NextResponse.json({error:"All fields are required"},{status:400});await (0,p.Z)();let v=new(await r.e(374).then(r.bind(r,6374))).default(g),x=await v.save();return i.NextResponse.json({message:"Application submitted successfully",id:x._id},{status:201})}catch(e){return console.error("Error submitting application:",e),i.NextResponse.json({error:e instanceof Error?e.message:"Failed to submit application"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/applications/route",pathname:"/api/applications",filename:"route",bundlePath:"app/api/applications/route"},resolvedPagePath:"/Users/arpitmishra012/Downloads/Mars-Final/src/app/api/applications/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:g}=d,v="/api/applications/route";function x(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},4184:(e,t,r)=>{r.d(t,{Z:()=>i});var o=r(1185),n=r.n(o);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable inside .env");let a=process.env.MONGODB_URI,s=global.mongoose||{conn:null,promise:null},i=async function(){if(s.conn)return s.conn;s.promise||(s.promise=n().connect(a,{bufferCommands:!1,maxPoolSize:10,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3}).then(e=>(console.log("Connected to MongoDB"),e)).catch(e=>{throw console.error("MongoDB connection error:",e),e}));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[276,972],()=>r(2087));module.exports=o})();